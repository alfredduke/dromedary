{
  "Description":"Launch nested CloudFormation stack to provision all Dromedary resources",
  "AWSTemplateFormatVersion":"2010-09-09",
  "Parameters":{
    "Ec2SshKeyName":{
      "Type":"AWS::EC2::KeyPair::KeyName",
      "Description":"The ec2 key name to use for ssh access to the bootstrapping instance."
    }
  },
  "Resources":{
    "DynamoDBStack":{
      "Type":"AWS::CloudFormation::Stack",
      "Properties":{
        "TemplateURL":"https://s3.amazonaws.com/stelligent-training-public/public/dynamodb.json",
        "TimeoutInMinutes":"60"
      }
    },
    "VPCStack":{
      "Type":"AWS::CloudFormation::Stack",
      "Properties":{
        "TemplateURL":"https://s3.amazonaws.com/stelligent-training-public/public/vpc.json",
        "TimeoutInMinutes":"60"
      }
    },
    "IAMStack":{
      "Type":"AWS::CloudFormation::Stack",
      "Properties":{
        "TemplateURL":"https://s3.amazonaws.com/stelligent-training-public/public/iam.json",
        "TimeoutInMinutes":"60"
      }
    }
  },
  "Outputs":{
    "SubnetId":{
      "Value":{
        "Fn::GetAtt":[
          "VPCStack",
          "Outputs.SubnetId"
        ]
      }
    },
    "CfnInitRole":{
      "Value":{
        "Fn::GetAtt":[
          "IAMStack",
          "Outputs.InstanceRole"
        ]
      }
    },
    "InstanceProfile":{
      "Value":{
        "Fn::GetAtt":[
          "IAMStack",
          "Outputs.InstanceProfile"
        ]
      }
    },
    "CodeDeployServiceRoleARN":{
      "Value":{
        "Fn::GetAtt":[
          "IAMStack",
          "Outputs.CodeDeployServiceRoleARN"
        ]
      }
    },
    "CodePipelineTrustRoleARN":{
      "Value":{
        "Fn::GetAtt":[
          "IAMStack",
          "Outputs.CodePipelineTrustRoleARN"
        ]
      }
    },
    "VPC":{
      "Value":{
        "Fn::GetAtt":[
          "VPCStack",
          "Outputs.VPC"
        ]
      }
    }
  }
}